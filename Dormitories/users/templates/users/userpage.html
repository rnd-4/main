{% extends 'hostels/layout.html' %}
{% block title %} {{ username }} page {% endblock %}
{% block content %}
<div>
    <div class="card">
        <div class="card-header text-center">
            <h3>User Page</h3>
        </div>
        <div class="card-body">
            <div class="row">
                <div class="col text-center">
                    {% if not gender %}
                    <img src="https://th.bing.com/th/id/R.cec69a569d2d2224a738afb5ad8a419f?rik=VFoqor%2bvcZqRHA&riu=http%3a%2f%2fronaldmottram.co.nz%2fwp-content%2fuploads%2f2019%2f01%2fdefault-user-icon-8.jpg&ehk=KdwKcNMijBB2LcdEzKdT%2bIvtpFWIKQT2HetK7wCogdA%3d&risl=&pid=ImgRaw&r=0"
                         alt="avatar"
                         class="rounded-circle img-fluid" style="width: 150px;">
                    {% elif gender == "Male" %}
                    <img src="https://mdbcdn.b-cdn.net/img/Photos/new-templates/bootstrap-chat/ava3.webp" alt="avatar"
                         class="rounded-circle img-fluid" style="width: 150px;">
                    {% else %}
                    <img src="https://mdbcdn.b-cdn.net/img/Photos/new-templates/bootstrap-chat/ava4.webp" alt="avatar"
                         class="rounded-circle img-fluid" style="width: 150px;">
                    {% endif %}

                    <h5 class="my-3">Student id â„–:{{ username }}</h5>

                    {% if not statement_request or statement_request.approved %}
                    <button id="adjustUser" type="button" class="btn btn-primary btn-sm">Adjust user</button>
                    {% if not statement_request %}
                    <a href="{% url 'request' %}" class="btn btn-success btn-sm">Statement request</a>
                    {% endif %}
                    {% elif not statement_request.approved %}
                    <div class="alert alert-primary" role="alert">Your request is on processing</div>
                    {% endif %}

                    {% if messages %}
                    {% for message in messages %}
                    <div class="col mt-3">
                        <div class="alert alert-warning" role="alert">
                            {{ message }}
                        </div>
                    </div>
                    {% endfor %}
                    {% endif %}

                </div>
                <div class="col">
                    <div class="row">
                        <div class="col-sm-3">
                            <p class="mb-0">Full Name</p>
                        </div>
                        <div class="col-sm-9">
                            <p class="text-muted mb-0">{{ firstname }} {{ lastname }}</p>
                        </div>
                    </div>
                    <hr>
                    <div class="row">
                        <div class="col-sm-3">
                            <p class="mb-0">Email</p>
                        </div>
                        <div class="col-sm-9">
                            <p class="text-muted mb-0">{{ email }}</p>
                        </div>
                    </div>
                    <hr>
                    <div class="row">
                        <div class="col-sm-3">
                            <p class="mb-0">Location</p>
                        </div>
                        <div class="col-sm-9">
                            <p class="text-muted mb-0">{{ location }}</p>
                        </div>
                    </div>
                    <hr>
                    <div class="row">
                        <div class="col-sm-3">
                            <p class="mb-0">Gender</p>
                        </div>
                        <div class="col-sm-9">
                            <p class="text-muted mb-0">{{ gender }}</p>
                        </div>
                    </div>
                    <hr>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="row">
                                <div class="col-sm-6">
                                    <p class="mb-0">Faculty</p>
                                </div>
                                <div class="col-sm-6">
                                    <p class="text-muted mb-0">{{ faculty }}</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="row">
                                <div class="col-sm-6">
                                    <p class="mb-0">Everage score</p>
                                </div>
                                <div class="col-sm-6">
                                    <p class="text-muted mb-0">{{ everage_score }}</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    {% if room %}
    {% include "hostels/dormitorie.html" %}
    {% endif %}
</div>
<!-- Modal -->
<div class="modal fade show" id="staticBackdropLive" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
     aria-labelledby="staticBackdropLiveLabel" style="display: none;" aria-modal="true" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="staticBackdropLiveLabel">Adjust user</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form method="post" enctype="multipart/form-data">
                    {% csrf_token %}
                    <fieldset>
                        <div class="mb-3">
                            <label for="firstname" class="form-label">First Name</label>
                            <input name="firstname" id="firstname" class="form-control" value={{ firstname }}>
                        </div>
                        <div class="mb-3">
                            <label for="lastname" class="form-label">Last Name</label>
                            <input name="lastname" id="lastname" class="form-control" value={{ lastname }}>
                        </div>
                        <div class="mb-3">
                            <label for="location" class="form-label">Location</label>
                            <select name="location" id="location" class="form-select" value={{ location }}>
                                {% for region in regions %}
                                {% if region == location %}
                                <option selected>{{ region }}</option>
                                {% else %}
                                <option>{{ region }}</option>
                                {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="faculty" class="form-label">Faculty</label>
                            <select name="faculty" id="faculty" class="form-select">
                                {% for f in facultys %}
                                {% if f == faculty %}
                                <option selected>{{ f }}</option>
                                {% else %}
                                <option>{{ f }}</option>
                                {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="everage_score" class="form-label">Average score</label>
                            <input name="everage_score" id="everage_score" class="form-control" value={{ everage_score }}>
                        </div>
                        <div class="mb-3">
                            <label for="gender" class="form-label">Gender</label>
                            <select name="gender" id="gender" class="form-select" value={{ gender }}>
                                <option>Male</option>
                                <option>Female</option>
                            </select>
                        </div>
                    </fieldset>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" id="close">Close
                        </button>
                        <button type="submit" class="btn btn-primary" class="save">Save</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- Modeal Script -->
<script>
// Get the modal
var modal = document.getElementById("staticBackdropLive");

// Get the button that opens the modal
var btn = document.getElementById("adjustUser");

// Get the button that opens the modal
var close = document.getElementById("close");

// Get the button that opens the modal
var save = document.getElementById("save");

// Get the <span> element that closes the modal
var span = document.getElementsByClassName("btn-close")[0];

// When the user clicks the button, open the modal 
btn.onclick = function() {
  modal.style.display = "block";
}

// When the user clicks on <span> (x), close the modal
span.onclick = function() {
  modal.style.display = "none";
}

// When the user clicks on close button, close the modal
close.onclick = function(){
    modal.style.display = "none";
}

// When the user clicks on save button, close the modal
save.onclick = function(){
    modal.style.display = "none";
}

// When the user clicks anywhere outside of the modal, close it
window.onclick = function(event) {
  if (event.target == modal) {
    modal.style.display = "none";
  }
}
</script>
{% endblock %}